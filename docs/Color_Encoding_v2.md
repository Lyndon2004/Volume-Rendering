# 海洋含氧量 Transfer Function 设计 v2

## 📊 数据分布分析

基于实际数据 `volume_oxygen_data_time_0_255.raw` 的统计分析：

```
总体素数: 16,228,800
原始范围: 0 - 203
归一化范围: 0 - 1 (除以 203)
```

### 分位数分布
| 分位数 | 归一化值 |
|--------|----------|
| 10% | 0.000 |
| 25% | 0.000 |
| 50% | 0.000 |
| 75% | 0.000 |
| 90% | 0.773 |
| 95% | 0.788 |
| 99% | 0.793 |

### 区间占比
| 密度区间 | 占比 | 说明 |
|----------|------|------|
| 0.0 - 0.2 | **79.2%** | 边界/陆地（值=0） |
| 0.2 - 0.4 | 0.0% | 几乎无数据 |
| 0.4 - 0.6 | 1.0% | 过渡区 |
| 0.6 - 0.8 | **19.2%** | 真正的海洋数据 |
| 0.8 - 1.0 | 0.5% | 高含氧区 |

**关键发现**：
- ~80% 是边界/陆地（值=0），需要隐藏
- 真正的海洋数据集中在 **0.77-0.79** 这个极窄范围
- 颜色映射需要在 0.6-0.8 区间展开

---

## 🎨 颜色映射设计

### 设计原则
1. **隐藏边界**：0-0.5 完全透明
2. **聚焦有效区间**：0.55-0.8 展开完整色谱
3. **语义化颜色**：红=低含氧（警告），蓝=高含氧（良好）

### 颜色控制点

```
密度值    →    RGB 颜色           →    视觉效果
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
0.00     →    (0.1, 0.1, 0.1)    →    暗灰色（透明，不显示）
0.55     →    (0.9, 0.1, 0.0)    →    鲜红色 🔴
0.68     →    (0.95, 0.5, 0.0)   →    橙色 🟠
0.73     →    (0.95, 0.85, 0.1)  →    黄色 🟡
0.76     →    (0.4, 0.9, 0.3)    →    绿色 🟢
0.79     →    (0.2, 0.6, 0.9)    →    浅蓝色 🔵
1.00     →    (0.1, 0.2, 0.95)   →    深蓝色 🔵
```

### 透明度控制点

```
密度值    →    Alpha    →    说明
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
0.00     →    0.0      →    完全透明（边界不显示）
0.50     →    0.0      →    完全透明（过渡）
0.60     →    0.5      →    半透明（开始可见）
0.70     →    0.7      →    较可见
0.76     →    0.8      →    清晰可见（主数据区）
0.85     →    0.75     →    可见
1.00     →    0.7      →    可见
```

---

## 🌊 含氧量语义映射

基于数据实际分布，颜色的**物理意义**：

| 颜色 | 密度范围 | 含氧量含义 | 关注程度 |
|------|----------|-----------|----------|
| 🔴 红色 | 0.55-0.68 | 低含氧警告区 | ⚠️ 高关注 |
| 🟠 橙色 | 0.68-0.73 | 中低含氧区 | ⚠️ 需注意 |
| 🟡 黄色 | 0.73-0.76 | 中等含氧区 | 📊 正常偏低 |
| 🟢 绿色 | 0.76-0.79 | 适宜含氧区 | ✅ 正常 |
| 🔵 蓝色 | 0.79-1.0 | 高含氧区 | ✅ 良好 |

**注意**：由于数据集中在 0.77-0.79，大部分区域会显示为 **绿色→浅蓝色**，这表示海洋含氧量总体处于适宜水平。

---

## 📁 文件信息

**Transfer Function 文件**：
```
路径: RenderingModule/Assets/Resources/oxygen_semantic.tf
格式: JSON
版本: v2 (基于数据分布优化)
```

**适用数据**：
```
文件: OneDayData/volume_oxygen_data_time_0_255.raw
维度: 400 × 441 × 92
格式: uint8
原始范围: 0-203
```

---

## 🔧 调整建议

如果需要进一步调整颜色分布：

### 方案 A：更多颜色层次
如果希望在 0.76-0.79 之间看到更多颜色变化，可以：
```
0.76 → 绿色
0.77 → 青色
0.78 → 浅蓝
0.79 → 蓝色
```

### 方案 B：强调低氧区
如果希望低氧区（即使很少）更明显：
- 降低红色起点：0.55 → 0.50
- 提高红色区 Alpha：0.5 → 0.9

### 方案 C：隐藏更多边界
如果边界仍有残留显示：
- 提高透明区间：0-0.5 透明 → 0-0.55 透明

---

## 📈 版本历史

| 版本 | 日期 | 变更 |
|------|------|------|
| v1 | - | 原始设计，假设数据均匀分布 0-1 |
| v2 | 2026-01-16 | 基于实际数据分布重新设计，聚焦 0.6-0.8 区间 |
